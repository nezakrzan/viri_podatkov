}
par(oldpar)
df = data[1:5]
mc <- Mclust(data=df, G=1:5)
summary(mc)
plot(x=mc, what="BIC", xlab="stevilo skupin")
# priorControl
mcP <- Mclust(data=df, G=1:5, prior = priorControl())
summary(mcP)
plot(mcP, what = "BIC", xlab="stevilo skupin")
mc <- Mclust(data=dfz, G=1:5)
summary(mc)
plot(x=mc, what="BIC", xlab="stevilo skupin")
# priorControl
mcP <- Mclust(data=dfz, G=1:5, prior = priorControl())
summary(mcP)
plot(mcP, what = "BIC", xlab="stevilo skupin")
# nestandardizirani
mcSEL <- Mclust(data=df, G=1:5, modelNames = c("VEE", "EEE"))
# modela na treh skupinah
mcVEE <- Mclust(data=df, G = 3, modelNames = "VEE")
mcEEE <- Mclust(data=df, G = 3, modelNames = "EEE")
# standardizirani
mcSEL.s <- Mclust(data=dfz, G=1:5, modelNames = c("VEE", "EEE"))
# modela na treh skupinah
mcVEE.s <- Mclust(data=dfz, G = 3, modelNames = "VEE")
mcEEE.s <- Mclust(data=dfz, G = 3, modelNames = "EEE")
oldpar <- par(las=1, mfrow=c(1, 2))
plot(mcSEL, what="BIC", legendArgs = list(x = "bottomright"), xlab="stevilo skupin", main="Nestandardizirani podatki")
plot(mcSEL.s, what="BIC", legendArgs = list(x = "bottomright"), xlab="stevilo skupin", main="Standardizirani podatki")
par(oldpar)
# tukej sm dal stevilo skupin na n=3 k so tud boljsi rezultati
oldpar <- par(las=1, mfrow=c(1, 3))
nsk <- 3
sk <- km3$cluster
sk.ime <- paste("sk", 1:nsk, sep="")
agr <- aggregate(x=dfz, by=list(sk), FUN=mean)
y <- t(agr[, -1])
matplot(x=seq_along(ime), y=y, type="o", pch=16, ylim=c(-2, 2), xlab="",
xaxt="n", ylab="povprecje (standardizirane spremenljivke)", main = "k-means")
axis(side=1, at=seq_along(ime), labels=ime, las=2)
legend("bottomleft", legend=sk.ime, col=1:nsk, pch=16)
abline(h=0, v=6.5)
nsk <- 3
sk <- hc.ward3
sk.ime <- paste("sk", 1:nsk, sep="")
agr <- aggregate(x=dfz, by=list(sk), FUN=mean)
y <- t(agr[, -1])
matplot(x=seq_along(ime), y=y, type="o", pch=16, ylim=c(-2, 2), xlab="",
xaxt="n", ylab="", main = "Ward")
axis(side=1, at=seq_along(ime), labels=ime, las=2)
legend("bottomleft", legend=sk.ime, col=1:nsk, pch=16)
abline(h=0, v=6.5)
nsk <- 3
sk <- mcVEE.s$classification
sk.ime <- paste("sk", 1:nsk, sep="")
agr <- aggregate(x=dfz, by=list(sk), FUN=mean)
y <- t(agr[, -1])
matplot(x=seq_along(ime), y=y, type="o", pch=16, ylim=c(-2, 2), xlab="",
xaxt="n", ylab="", main = "VEE(BIC)")
axis(side=1, at=seq_along(ime), labels=ime, las=2)
legend("bottomleft", legend=sk.ime, col=1:nsk, pch=16)
abline(h=0, v=6.5)
par(oldpar)
wkf <- NULL
wkf <- rbind(wkf, c(WardKF(dfz, km3$cluster), WardKF(dfz, hc.ward3), WardKF(dfz, mcVEE.s$classification) ))
colnames(wkf) <- c("k-means", "Ward", "VEE(BIC)")
kable(wkf, caption = "Primerjava vrednosti Wardove kriterijske funkcije za vse metode.") %>%
kable_styling(full_width=F, latex_options="hold_position")
# kako podobni sta si razvrstitvi; popravljen randov indeks
r = data.frame( wk = round(adjustedRandIndex(hc.ward3, km3$cluster),3), # ward in k-means
wv = round(adjustedRandIndex(hc.ward3, mcVEE.s$classification),3), #ward in VEE
kv = round(adjustedRandIndex(km3$cluster, mcVEE.s$classification),3)) # k-means in Vee
colnames(r) <- c("Ward in k-means", "Ward in VEE(BIC)", "k-means in VEE(BIC)")
kable(r, caption = "Primerjava popravljenega Randovega indeksa.") %>%
kable_styling(full_width=F, latex_options="hold_position")
# dodamo skupine v podatke
nsk = 3
sk.k = km3$cluster
sk.w = hc.ward3
sk.v = mcVEE.s$classification
sk.k.ime = paste("sk", 1:nsk, sep="")
sk.w.ime = paste("sk", 1:nsk, sep="")
sk.v.ime = paste("sk", 1:nsk, sep="")
data$cluster.k = sk.k
data$cluster.w = sk.w
data$cluster.v = sk.v
data$skupina.k = factor(x=sk.k, labels=sk.k.ime)
data$skupina.w = factor(x=sk.w, labels=sk.w.ime)
data$skupina.v = factor(x=sk.v, labels=sk.v.ime)
# velikost skupin
table(data$skupina.k)
# pogledamo povprecja (nestandardizirane vrednosti)
agr.v1 <- aggregate(v1 ~ skupina.k, data=data, FUN=mean)
agr.v2 <- aggregate(v2 ~ skupina.k, data=data, FUN=mean)
cbind(agr.v1, agr.v2)
table(data$skupina.w)
# pogledamo povprecja (nestandardizirane vrednosti)
agr.v1 <- aggregate(v1 ~ skupina.w, data=data, FUN=mean)
agr.v2 <- aggregate(v2 ~ skupina.w, data=data, FUN=mean)
cbind(agr.v1, agr.v2)
table(data$skupina.v)
# pogledamo povprecja (nestandardizirane vrednosti)
agr.v1 <- aggregate(v1 ~ skupina.v, data=data, FUN=mean)
agr.v2 <- aggregate(v2 ~ skupina.v, data=data, FUN=mean)
cbind(agr.v1, agr.v2)
# pogledamo povprecja (nestandardizirane vrednosti)
agr.v1 <- aggregate(v1 ~ skupina.k, data=data, FUN=mean)
agr.v2 <- aggregate(v2 ~ skupina.k, data=data, FUN=mean)
cbind(agr.v1, agr.v2)
#	jitter + razsevni grafikon
#	horizontalna in vertikalna zrta oznazujeta povprezno vrednost
#	X oznazuje centroid skupine
x <- jitter(data$v1, amount=0.1)
y <- jitter(data$v2, amount=0.1)
#oldpar <- par(las=1, mfrow=c(1, 3))
plot(x=x, y=y, xlab="dolzina", ylab="mere", asp=1, col=data$skupina.k, las=1, main="k-means")
legend("bottomright", legend=sk.k.ime, col=1:nsk, pch=16)
abline(v=mean(data$v1))
abline(h=mean(data$v2))
points(x=agr.v1[, -1], y=agr.v2[, -1], cex=2, col="blue", pch="X")
#plot(x=x, y=y, xlab="dolzina", ylab="mere", asp=1, col=data$skupina.w, las=1, main="Ward")
#legend("bottomright", legend=sk.w.ime, col=1:nsk, pch=16)
#abline(v=mean(data$v1))
#abline(h=mean(data$v2))
#points(x=agr.v1[, -1], y=agr.v2[, -1], cex=2, col="blue", pch="X")
#plot(x=x, y=y, xlab="dolzina", ylab="mere", asp=1, col=data$skupina.v, las=1, main="VEE(BIC)")
#legend("bottomright", legend=sk.v.ime, col=1:nsk, pch=16)
#abline(v=mean(data$v1))
#abline(h=mean(data$v2))
#points(x=agr.v1[, -1], y=agr.v2[, -1], cex=2, col="blue", pch="X")
#par(oldpar)
### OPIS LASTNOSTI SKUPIN
# povezanost skupin z ostalimi spremenljivkami
# graficni prikaz
( tabela <- 100*proportions(x=table(data$tip, data$skupina.k), margin=2) )
barplot(height=tabela, legend.text=T, ylim=c(0, 130), args.legend=list(x="top"), las=1, main = "k-means")
abline(h=(100*table(data$tip)/nrow(df))[1], col="red")
boxplot(diagonala~skupina.k,data=data, main="k-means", xlab = "skupine", ylab="diagonala")
mx <- aggregate(diagonala ~ skupina.k, data=data, FUN=mean)[, -1]
abline(h=mean(data$diagonala), col="red")
points(x=mx, col="blue", pch="X")
# test povezanosti (vec kategoriji = anova)
# predpostavljamo neenake variance na populaciji
oneway.test(diagonala ~ skupina.k, data=data, var.equal=F)
knitr::opts_chunk$set(echo = TRUE, fig.pos = 'H', fig.align="center", echo=FALSE, results = F)
library(cluster)
library(mclust)
library(foreign)
library(psych)
set.seed(2020)
# Ward skupine
hc.ward1 <- cutree(tree=hc.ward, k=1)
knitr::opts_chunk$set(echo = TRUE, fig.pos = 'H', fig.align="center", echo=FALSE, results = F)
library(cluster)
library(mclust)
library(foreign)
library(psych)
set.seed(2020)
data = read.table("data.txt", header = T, sep = "", dec = ".")
setwd("~/Documents/GitHub/viri_podatkov/multivariatna_analiza/01_dn")
knitr::opts_chunk$set(echo = TRUE, fig.pos = 'H', fig.align="center", echo=FALSE, results = F)
library(cluster)
library(mclust)
library(foreign)
library(psych)
set.seed(2020)
data = read.table("data.txt", header = T, sep = "", dec = ".")
str(data)
nrow(data)
colnames(data)
knitr::include_graphics("ban.png")
# preimenovanje stolpcev
colnames(data) <- c('dolzina','levi.rob','desni.rob', 'spodnji.rob', 'zgornji.rob', 'diagonala', 'tip')
# nastavim stolpec kot faktor
data$tip <- as.factor(data$tip)
levels(data$tip)
# prevedem v slovenščino
levels(data$tip) <- c("ponarejen bankovec", "pravi bankovec")
levels(data$tip)
library(vtable)
#napovedne spremenljivke
pred <- c('dolzina','levi.rob','desni.rob', 'spodnji.rob', 'zgornji.rob', 'diagonala')
#sumtable(data[,pred], add.median = T, digits = 1,
#         title = "Opisne statistike za števillske spremenljivke v podatkovnem okviru Swiss banknotes data.", #simple.kable = T, out = 'kable', fit.page = "\textwidth")
stat = data.frame(spremenljivke = c("dolzina", "levi.rob", "desni.rob", "spodnji.rob", "zgornji.rob", "diagonala"),
N = c(rep(200,6)),
mean = c(215, 130, 130, 9, 11, 140),
Std.Dev. = c(0.4, 0.4, 0.4, 1, 0.8, 1),
Min = c(214, 129, 129, 7, 8, 138),
Pctl.25 = c(215, 130, 130, 8, 10, 140),
Pctl.50 = c(215, 130, 130, 9, 11, 140),
Pctl.75 = c(215, 130, 130, 11, 11, 142),
Max = c(216,131,131,13,12,142))
kable(stat,
caption="Opisne statistike za števillske spremenljivke v podatkovnem okviru Swiss banknotes data.") %>%
kable_styling(full_width=F, latex_options="hold_position")
# matrika razliznosti na standardiziranih podatkih (Evklidska razdalja)
dz <- dist(x=dfz, method="euclidean")
# skaliranje podatkov
# vprasanje: misls da skalirava tud diagonalo k jo uporabva za analizo?, zdej ni skalirana
# odgovor: sva skalirala samo spremenljivke za razvrscanje
dfz <- scale(x=data[1:5])
# matrika razliznosti na standardiziranih podatkih (Evklidska razdalja)
dz <- dist(x=dfz, method="euclidean")
hc.ward <- hclust(d=dz, method="ward.D2")
oldpar <- par(las=1, mfrow=c(1, 3))
barplot(hc.ward$height)
barplot(tail(x=hc.ward$height, n=10), names.arg=rev(seq_len(10)))
plot(hc.ward, labels=F, hang=-1, main="Ward", sub="", xlab="", ylab="")
par(oldpar)
# uporabili smo Evklidsko razdaljo
hc.sin <- hclust(d=dz, method="single")
oldpar <- par(las=1, mfrow=c(1, 3))
barplot(hc.sin$height)
barplot(tail(x=hc.sin$height, n=10), names.arg=rev(seq_len(10)))
plot(hc.sin, labels=F, hang=-1, main="Single", sub="", xlab="", ylab="")
par(oldpar)
# uporabili smo Evklidsko razdaljo
hc.com <- hclust(d=dz, method="complete")
oldpar <- par(las=1, mfrow=c(1, 3))
barplot(hc.com$height)
barplot(tail(x=hc.com$height, n=10), names.arg=rev(seq_len(10)))
plot(hc.com, labels=F, hang=-1, main="Complete", sub="", xlab="", ylab="")
par(oldpar)
# Ward skupine
hc.ward1 <- cutree(tree=hc.ward, k=1)
hc.ward2 <- cutree(tree=hc.ward, k=2)
hc.ward3 <- cutree(tree=hc.ward, k=3)
hc.ward4 <- cutree(tree=hc.ward, k=4)
ime = c('dolzina','levi.rob','desni.rob', 'spodnji.rob', 'zgornji.rob')
oldpar <- par(las=1, mfrow=c(1, 3))
nsk <- 2
sk <- hc.ward2
sk.ime <- paste("sk", 1:nsk, sep="")
agr <- aggregate(x=dfz, by=list(sk), FUN=mean)
y <- t(agr[, -1])
matplot(x=seq_along(ime), y=y, type="o", pch=16, ylim=c(-2, 2), xlab="",
ylab="ovprecje (standardizirane spremenljivke)")
axis(side=1, at=seq_along(ime), labels=ime, las=2)
legend("bottomleft", legend=sk.ime, col=1:nsk, pch=16)
abline(h=0, v=6.5)
nsk <- 3
sk <- hc.ward3
sk.ime <- paste("sk", 1:nsk, sep="")
agr <- aggregate(x=dfz, by=list(sk), FUN=mean)
y <- t(agr[, -1])
matplot(x=seq_along(ime), y=y, type="o", pch=16, ylim=c(-2, 2), xlab="",
ylab="")
axis(side=1, at=seq_along(ime), labels=ime, las=2)
legend("bottomleft", legend=sk.ime, col=1:nsk, pch=16)
abline(h=0, v=6.5)
nsk <- 4
sk <- hc.ward4
sk.ime <- paste("sk", 1:nsk, sep="")
agr <- aggregate(x=dfz, by=list(sk), FUN=mean)
y <- t(agr[, -1])
matplot(x=seq_along(ime), y=y, type="o", pch=16, ylim=c(-2, 2), xlab="",
ylab="")
axis(side=1, at=seq_along(ime), labels=ime, las=2)
legend("bottomleft", legend=sk.ime, col=1:nsk, pch=16)
abline(h=0, v=6.5)
par(oldpar)
wkf <- NULL
wkf <- rbind(wkf, c(WardKF(dfz, km3$cluster), WardKF(dfz, hc.ward3)))
knitr::opts_chunk$set(echo = TRUE, fig.pos = 'H', fig.align="center", echo=FALSE, results = F)
library(cluster)
library(mclust)
library(foreign)
library(psych)
set.seed(2020)
data = read.table("data.txt", header = T, sep = "", dec = ".")
str(data)
nrow(data)
colnames(data)
knitr::include_graphics("ban.png")
# preimenovanje stolpcev
colnames(data) <- c('dolzina','levi.rob','desni.rob', 'spodnji.rob', 'zgornji.rob', 'diagonala', 'tip')
# nastavim stolpec kot faktor
data$tip <- as.factor(data$tip)
levels(data$tip)
# prevedem v slovenščino
levels(data$tip) <- c("ponarejen bankovec", "pravi bankovec")
levels(data$tip)
library(vtable)
#napovedne spremenljivke
pred <- c('dolzina','levi.rob','desni.rob', 'spodnji.rob', 'zgornji.rob', 'diagonala')
#sumtable(data[,pred], add.median = T, digits = 1,
#         title = "Opisne statistike za števillske spremenljivke v podatkovnem okviru Swiss banknotes data.", #simple.kable = T, out = 'kable', fit.page = "\textwidth")
stat = data.frame(spremenljivke = c("dolzina", "levi.rob", "desni.rob", "spodnji.rob", "zgornji.rob", "diagonala"),
N = c(rep(200,6)),
mean = c(215, 130, 130, 9, 11, 140),
Std.Dev. = c(0.4, 0.4, 0.4, 1, 0.8, 1),
Min = c(214, 129, 129, 7, 8, 138),
Pctl.25 = c(215, 130, 130, 8, 10, 140),
Pctl.50 = c(215, 130, 130, 9, 11, 140),
Pctl.75 = c(215, 130, 130, 11, 11, 142),
Max = c(216,131,131,13,12,142))
kable(stat,
caption="Opisne statistike za števillske spremenljivke v podatkovnem okviru Swiss banknotes data.") %>%
kable_styling(full_width=F, latex_options="hold_position")
# skaliranje podatkov
# vprasanje: misls da skalirava tud diagonalo k jo uporabva za analizo?, zdej ni skalirana
# odgovor: sva skalirala samo spremenljivke za razvrscanje
dfz <- scale(x=data[1:5])
# matrika razliznosti na standardiziranih podatkih (Evklidska razdalja)
dz <- dist(x=dfz, method="euclidean")
hc.ward <- hclust(d=dz, method="ward.D2")
oldpar <- par(las=1, mfrow=c(1, 3))
barplot(hc.ward$height)
barplot(tail(x=hc.ward$height, n=10), names.arg=rev(seq_len(10)))
plot(hc.ward, labels=F, hang=-1, main="Ward", sub="", xlab="", ylab="")
par(oldpar)
# uporabili smo Evklidsko razdaljo
hc.sin <- hclust(d=dz, method="single")
oldpar <- par(las=1, mfrow=c(1, 3))
barplot(hc.sin$height)
barplot(tail(x=hc.sin$height, n=10), names.arg=rev(seq_len(10)))
plot(hc.sin, labels=F, hang=-1, main="Single", sub="", xlab="", ylab="")
par(oldpar)
# uporabili smo Evklidsko razdaljo
hc.com <- hclust(d=dz, method="complete")
oldpar <- par(las=1, mfrow=c(1, 3))
barplot(hc.com$height)
barplot(tail(x=hc.com$height, n=10), names.arg=rev(seq_len(10)))
plot(hc.com, labels=F, hang=-1, main="Complete", sub="", xlab="", ylab="")
par(oldpar)
# Ward skupine
hc.ward1 <- cutree(tree=hc.ward, k=1)
hc.ward2 <- cutree(tree=hc.ward, k=2)
hc.ward3 <- cutree(tree=hc.ward, k=3)
hc.ward4 <- cutree(tree=hc.ward, k=4)
ime = c('dolzina','levi.rob','desni.rob', 'spodnji.rob', 'zgornji.rob')
oldpar <- par(las=1, mfrow=c(1, 3))
nsk <- 2
sk <- hc.ward2
sk.ime <- paste("sk", 1:nsk, sep="")
agr <- aggregate(x=dfz, by=list(sk), FUN=mean)
y <- t(agr[, -1])
matplot(x=seq_along(ime), y=y, type="o", pch=16, ylim=c(-2, 2), xlab="",
ylab="ovprecje (standardizirane spremenljivke)")
axis(side=1, at=seq_along(ime), labels=ime, las=2)
legend("bottomleft", legend=sk.ime, col=1:nsk, pch=16)
abline(h=0, v=6.5)
nsk <- 3
sk <- hc.ward3
sk.ime <- paste("sk", 1:nsk, sep="")
agr <- aggregate(x=dfz, by=list(sk), FUN=mean)
y <- t(agr[, -1])
matplot(x=seq_along(ime), y=y, type="o", pch=16, ylim=c(-2, 2), xlab="",
ylab="")
axis(side=1, at=seq_along(ime), labels=ime, las=2)
legend("bottomleft", legend=sk.ime, col=1:nsk, pch=16)
abline(h=0, v=6.5)
nsk <- 4
sk <- hc.ward4
sk.ime <- paste("sk", 1:nsk, sep="")
agr <- aggregate(x=dfz, by=list(sk), FUN=mean)
y <- t(agr[, -1])
matplot(x=seq_along(ime), y=y, type="o", pch=16, ylim=c(-2, 2), xlab="",
ylab="")
axis(side=1, at=seq_along(ime), labels=ime, las=2)
legend("bottomleft", legend=sk.ime, col=1:nsk, pch=16)
abline(h=0, v=6.5)
par(oldpar)
# WSS
kmax <- 10
wss <- NULL
for (k in 1:kmax) {
withinss <- kmeans(x=dfz, # podatki
centers=k, # st. skupin
nstart=100)$tot.withinss # st. ponovitev
wss <- c(wss, withinss)
}
plot(x=1:kmax, y=wss, type="b", main="", xlab="stevilo skupin(k)",
ylab="vrednost Wardowe kriterijske funkcije")
# gap statistika
gap_stat <- clusGap(x=dfz, FUNcluster=kmeans, K.max=kmax)
plot(gap_stat, xlab="stevilo skupin", main="")
# Pseudo F (Calinski and Harabasz index)
pseudoF <- 0
bss <- wss[1] - wss
for (k in 2:kmax) pseudoF <- c(pseudoF, (bss[k]/(k-1)) / (wss[k]/(nrow(dfz)-k)))
plot(x=1:kmax, y=pseudoF, type="b", xlab="stevilo skupin",
ylab="Pseudo F", main="")
km1 <- kmeans(x=dfz, centers=1, nstart=1)
km2 <- kmeans(x=dfz, centers=2, nstart=100)
km3 <- kmeans(x=dfz, centers=3, nstart=100)
km4 <- kmeans(x=dfz, centers=4, nstart=100)
# Wardova kriterijska funkcija
WardKF <- function(data, cluster){
# vsota kvadratov
# x = ena spremenljivka
ss <- function(x) sum((x-mean(x))^2)
# vsota kvadratov znotraj ene skupine po vseh spremenljivkah
# X = matrika, stolpci so spremenljivke
withinss <- function(X) sum(apply(X=X, MARGIN=2, FUN=ss))
# vsota kvadratov vseh skupin
sum(by(data=data, INDICES=cluster, FUN=withinss))
}
wkf <- NULL
wkf <- rbind(wkf, c(WardKF(dfz, hc.ward1), WardKF(dfz, hc.ward2), WardKF(dfz, hc.ward3), WardKF(dfz, hc.ward4)))
wkf <- rbind(wkf, c(WardKF(dfz, km1$cluster), WardKF(dfz, km2$cluster), WardKF(dfz, km3$cluster), WardKF(dfz, km4$cluster)))
rownames(wkf) <- c("Ward", "Kmeans")
colnames(wkf) <- c("k=1", "k=2", "k=3", "k=4")
kable(wkf, caption = "Primerjava vrednosti kriterijske funkcije za Wardowo metodo in K-means.") %>%
kable_styling(full_width=F, latex_options="hold_position")
# kontingenčna tabela
#table(km4$cluster, c(3, 2, 4, 1)[hc.ward4])
kable(table(km3$cluster, c(1,3,2)[hc.ward3]), caption = "Kontingenčna tabela.") %>%
kable_styling(full_width=F, latex_options="hold_position")
# popravljen Randov indeks
r = adjustedRandIndex(x=km3$cluster, y=hc.ward3)
oldpar <- par(las=1, mfrow=c(2, 3))
for (i in seq_along(ime)) {
hist(data[, ime[i]],
main=ime[i],
xlab="",
ylab="Frekvenca")
}
par(oldpar)
df = data[1:5]
mc <- Mclust(data=df, G=1:5)
summary(mc)
plot(x=mc, what="BIC", xlab="stevilo skupin")
# priorControl
mcP <- Mclust(data=df, G=1:5, prior = priorControl())
summary(mcP)
plot(mcP, what = "BIC", xlab="stevilo skupin")
mc <- Mclust(data=dfz, G=1:5)
summary(mc)
plot(x=mc, what="BIC", xlab="stevilo skupin")
# priorControl
mcP <- Mclust(data=dfz, G=1:5, prior = priorControl())
summary(mcP)
plot(mcP, what = "BIC", xlab="stevilo skupin")
# nestandardizirani
mcSEL <- Mclust(data=df, G=1:5, modelNames = c("VEE", "EEE"))
# modela na treh skupinah
mcVEE <- Mclust(data=df, G = 3, modelNames = "VEE")
mcEEE <- Mclust(data=df, G = 3, modelNames = "EEE")
# standardizirani
mcSEL.s <- Mclust(data=dfz, G=1:5, modelNames = c("VEE", "EEE"))
# modela na treh skupinah
mcVEE.s <- Mclust(data=dfz, G = 3, modelNames = "VEE")
mcEEE.s <- Mclust(data=dfz, G = 3, modelNames = "EEE")
oldpar <- par(las=1, mfrow=c(1, 2))
plot(mcSEL, what="BIC", legendArgs = list(x = "bottomright"), xlab="stevilo skupin", main="Nestandardizirani podatki")
plot(mcSEL.s, what="BIC", legendArgs = list(x = "bottomright"), xlab="stevilo skupin", main="Standardizirani podatki")
par(oldpar)
# tukej sm dal stevilo skupin na n=3 k so tud boljsi rezultati
oldpar <- par(las=1, mfrow=c(1, 3))
nsk <- 3
sk <- km3$cluster
sk.ime <- paste("sk", 1:nsk, sep="")
agr <- aggregate(x=dfz, by=list(sk), FUN=mean)
y <- t(agr[, -1])
matplot(x=seq_along(ime), y=y, type="o", pch=16, ylim=c(-2, 2), xlab="",
xaxt="n", ylab="povprecje (standardizirane spremenljivke)", main = "k-means")
axis(side=1, at=seq_along(ime), labels=ime, las=2)
legend("bottomleft", legend=sk.ime, col=1:nsk, pch=16)
abline(h=0, v=6.5)
nsk <- 3
sk <- hc.ward3
sk.ime <- paste("sk", 1:nsk, sep="")
agr <- aggregate(x=dfz, by=list(sk), FUN=mean)
y <- t(agr[, -1])
matplot(x=seq_along(ime), y=y, type="o", pch=16, ylim=c(-2, 2), xlab="",
xaxt="n", ylab="", main = "Ward")
axis(side=1, at=seq_along(ime), labels=ime, las=2)
legend("bottomleft", legend=sk.ime, col=1:nsk, pch=16)
abline(h=0, v=6.5)
nsk <- 3
sk <- mcVEE.s$classification
sk.ime <- paste("sk", 1:nsk, sep="")
agr <- aggregate(x=dfz, by=list(sk), FUN=mean)
y <- t(agr[, -1])
matplot(x=seq_along(ime), y=y, type="o", pch=16, ylim=c(-2, 2), xlab="",
xaxt="n", ylab="", main = "VEE(BIC)")
axis(side=1, at=seq_along(ime), labels=ime, las=2)
legend("bottomleft", legend=sk.ime, col=1:nsk, pch=16)
abline(h=0, v=6.5)
par(oldpar)
wkf <- NULL
wkf <- rbind(wkf, c(WardKF(dfz, km3$cluster), WardKF(dfz, hc.ward3)))
colnames(wkf) <- c("k-means", "Ward")
kable(wkf, caption = "Primerjava vrednosti Wardove kriterijske funkcije za vse metode.") %>%
kable_styling(full_width=F, latex_options="hold_position")
# dodamo skupine v podatke
nsk = 3
sk.k = km3$cluster
sk.w = hc.ward3
sk.v = mcVEE.s$classification
sk.k.ime = paste("sk", 1:nsk, sep="")
sk.w.ime = paste("sk", 1:nsk, sep="")
sk.v.ime = paste("sk", 1:nsk, sep="")
data$cluster.k = sk.k
data$cluster.w = sk.w
data$cluster.v = sk.v
data$skupina.k = factor(x=sk.k, labels=sk.k.ime)
data$skupina.w = factor(x=sk.w, labels=sk.w.ime)
data$skupina.v = factor(x=sk.v, labels=sk.v.ime)
# velikost skupin
kable(table(data$skupina.k), caption = "Velikost skupin pri metodi k -means.",
col.names= c("skupina", "velikost")) %>%
kable_styling(full_width=F, latex_options="hold_position")
kable(table(data$skupina.w), caption = "Velikost skupin pri Ward metodi.",
col.names= c("skupina", "velikost")) %>%
kable_styling(full_width=F, latex_options="hold_position")
kable(table(data$skupina.v), caption = "Velikost skupin pri VEE(BIC).",
col.names= c("skupina", "velikost")) %>%
kable_styling(full_width=F, latex_options="hold_position")
