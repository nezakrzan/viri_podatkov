---
title: "Predstavitev domačih nalog"
author: "Neža Kržan, Tom Rupnik"
output:
  pdf_document:
    fig_caption: true
    number_sections: true
  # word_document: default
header-includes:
- \usepackage[slovene]{babel}
- \usepackage{float}
- \usepackage[T1]{fontenc}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	fig.align = "center",
	fig.pos = "H",
	message = FALSE,
	warning = FALSE,
	results = F, fig.height = 4, fig.width = 5
)

library(kableExtra)
library(MASS)
library(mclust)

set.seed(2024)
```

# Diskriminantna analiza

```{r}
# branje podatkov
data <- read.csv("dn5_data_wine.csv", header=T)
dfz <- scale(x=data[,2:ncol(data)])
skupine = data[,1]
spremenljivke = c("Alcohol", "Malic_acid", "Ash",
                  "Alcalinity_of_ash", "Magnesium", "Total_phenols",
                  "Flavanoids", "Nonflavanoid_phenols",
                  "Proanthocyanins", "Color_intensity", "Hue",
                  "OD280_OD315",  "Proline")
```

## Slide 1

Podatkovni okvir z nalovom Wine - vsebuje 13 različnih lastnosti vina iz kemijske analize treh različnih sort. Iz teh komponent želimo določiti kateri sorti pripada vino.

Za skupine imamo sorte vina, označene so z številkami $1$, $2$ in $3$ in posameznih vin je glede na sorto:

```{r, results=T}
df_vel_skupin = data.frame("skupina" = c(1:3),
                           "koliko" = c(59,71,48),
                           "delež" = round(c(59,71,48)/178*100,2))

kable(df_vel_skupin, digits = 2,
      caption="Velikost skupin.", col.names = c("sorta vina", "število vin", "delež %")) %>% 
  kable_styling(full_width=F, latex_options="hold_position")
```

Poglejmo si še kako se sorte vina razlikujejo v povprečjih glede na lastnost na grafu, s katerega lahko vidimo, da večina spremenljivk dobro loči med sortami vina, je pa nekaj takih kjer to ne velja.

```{r fig.dim=c(6,4), fig.cap="Povprečja neodvisnih spremenljivk po skupinah (standardizirane vrednosti).", fig.pos="H"}
# povprecja neodvisnih spremenljivk 
par(mar = c(3, 3, 3, 8), xpd = TRUE) 
agr <- aggregate(x=dfz, by=list(skupine), FUN=mean)
matplot(x=seq_along(spremenljivke), y=t(agr[, -1]), type="o", pch=16, col=1:3, xaxt="n", xlab="", ylab="Povprecje", las=1)
axis(side=1, at=seq_along(spremenljivke), labels=spremenljivke, las=2, cex.axis=0.5)
legend("topright", inset = c(-0.15, 0), legend=agr[, 1], col=1:3, pch=16)
```

## Slide 2

Izvedli smo linearno diskriminantno analizo na standardiziranih podatkih in zanimalo nas je med katerimi sortami vina bolje ločuje posamezna diskriminantna funkcija. 

Prva linearna diskriminantna funkcija je najbolje ločuvala med sorto vina 1 in sorto vina 3. Druga linearna diskriminantna funkcija pa najbolje ločuje med sorto vina 1 in 2 ter 3 in 2, kar se zelo dobro vidi na spodnjem grafu. 

```{r, results=T, fig.cap="Grafični prikaz porazdelitev vrednosti po skupinah.", fig.width=8, fig.height=4}
X <- dfz
sk <- as.factor(data[, "Class"])
lda.fit <- lda(x=X, grouping=sk, method="moment")

lda.predict <- predict(object=lda.fit, dimen=2)
xLD1 <- lda.predict$x[, "LD1"]
xLD2 <- lda.predict$x[, "LD2"]
oldpar <- par(las=1, mfrow=c(1, 2))
plot(density(xLD1[which(sk=="1")]), xlim=c(-7, 8), ylim=c(0, 0.6), main="LD1")
lines(density(xLD1[which(sk=="2")]), col=2)
lines(density(xLD1[which(sk=="3")]), col=3)
legend("topleft", legend=levels(sk), col=1:3, pch=16)
plot(density(xLD2[which(sk=="1")]), xlim=c(-8, 5), ylim=c(0, 0.5), main="LD2")
lines(density(xLD2[which(sk=="2")]), col=2)
lines(density(xLD2[which(sk=="3")]), col=3)
legend("topleft", legend=levels(sk), col=1:3, pch=16)
par(oldpar)
```

Pri prvi diskriminantni funkciji je imela intenziteta barve pomembno vlogo, pri drugi pa na primer ne. 

## Slide 3

```{r, fig.cap="Prikaz enot glede na pravo pripadnost sorti vina(levo) in pripadnost posamezni skupini glede na klasifikacijo po LDA(desno).", fig.width=9}
# pripadnost sorta vina 1-3
par(mfrow=c(1,2))
plot(x=xLD1, y=xLD2, col=sk, xlim=c(-6, 6), ylim=c(-5, 5), main="Pripadnost (prava)", asp=1)
legend("bottomleft", legend=levels(sk), col=1:3, pch=16)
# pripadnost LDA
# barva oznacuje pripadnost skupini po klasifikaciji LDA
plot(x=xLD1, y=xLD2, col=lda.predict$class, xlim=c(-6, 6), ylim=c(-5, 5), main="Pripadnost (klasifikacija)", asp=1)
legend("bottomleft", legend=levels(lda.predict$class), col=1:3, pch=16)
```



